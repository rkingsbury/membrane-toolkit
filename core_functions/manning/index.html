
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Documentation for membrane-toolkit, Python tools for membrane science." name="description"/>
<link href="https://rkingsbury.github.io/membrane-toolkit/core_functions/manning/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-5.1.6" name="generator"/>
<title>Manning Theory - membrane-toolkit Documentation</title>
<link href="../../assets/stylesheets/main.4b9ffd7b.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.b79bcd20.min.css" rel="stylesheet"/>
<meta content="#03a9f4" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body data-md-color-accent="deep-orange" data-md-color-primary="light-blue" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#membrane_toolkit.core.manning.get_activity_coefficient_manning">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="membrane-toolkit Documentation" class="md-header-nav__button md-logo" href="https://rkingsbury.github.io/membrane-toolkit/" title="membrane-toolkit Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            membrane-toolkit Documentation
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Manning Theory
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/rkingsbury/membrane-toolkit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="membrane-toolkit Documentation" class="md-nav__button md-logo" href="https://rkingsbury.github.io/membrane-toolkit/" title="membrane-toolkit Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    membrane-toolkit Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/rkingsbury/membrane-toolkit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Home">
      Home
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/" title="Installation">
      Installation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting_started/" title="Getting Started">
      Getting Started
    </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Core Functions
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Core Functions" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-4">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Core Functions
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../diffusion/" title="Diffusion">
      Diffusion
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../donnan/" title="Donnan Equilibrium">
      Donnan Equilibrium
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Manning Theory
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Manning Theory">
      Manning Theory
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#membrane_toolkit.core.manning.get_activity_coefficient_manning">
    get_activity_coefficient_manning()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#membrane_toolkit.core.manning.diffusion_coefficient_manning">
    diffusion_coefficient_manning()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../potential/" title="Electrochemical Properties">
      Electrochemical Properties
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../develop/" title="For Developers">
      For Developers
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#membrane_toolkit.core.manning.get_activity_coefficient_manning">
    get_activity_coefficient_manning()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#membrane_toolkit.core.manning.diffusion_coefficient_manning">
    diffusion_coefficient_manning()
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/rkingsbury/membrane-toolkit/edit/master/docs/core_functions/manning.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1>Manning Theory</h1>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="membrane_toolkit.core.manning.get_activity_coefficient_manning">
<code class="highlight language-python">
membrane_toolkit.core.manning.get_activity_coefficient_manning<span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">C_fix</span><span class="p">,</span> <span class="n">Cs</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">'mean'</span><span class="p">,</span> <span class="n">nu_counter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nu_co</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_counter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_co</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> </code>
<a class="headerlink" href="#membrane_toolkit.core.manning.get_activity_coefficient_manning" title="Permanent link">¶</a></h2>
<div class="doc doc-contents first">
<p>Return an ion activity coefficient inside a charged polymer,
according to Manning theory</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xi</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the Manning parameter for the polymer,
dimensionless.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>C_fix</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the concentration of fixed charges, including sign.
Must be specified in mol/L of water absorbed by the polymer. Note that
monovalent charged groups are assumed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>Cs</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the concentraiton of mobile salt inside the
polymer. Must be specified in mol/L of water absorbed by the polymer.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>str</code></td>
<td>
<p>Specifies whether the counter-ion, co-ion, or the mean ionic activity
coefficient is returned. Valid arguments are 'counter', 'co', and
'mean'. Defaults to 'mean' if not specified.</p>
</td>
<td><code>'mean'</code></td>
</tr>
<tr>
<td><code>nu_counter</code></td>
<td><code>int</code></td>
<td>
<p>Stoichiometric coefficient of the counter-ion in the parent salt. Defaults to 1 if not specified.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>nu_co</code></td>
<td><code>int</code></td>
<td>
<p>int
Stoichiometric coefficient of the co-ion in the parent salt. Defaults to -1 if not specified.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>z_counter</code></td>
<td><code>int</code></td>
<td>
<p>Net charge, including sign, of the counter-ion. Defaults to +1 if not specified. Note that the sign of
z_counter must be opposite to the sign of C_fix.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>z_co</code></td>
<td><code>int</code></td>
<td>
<p>Net charge, including sign, of the co-ion. Defaults to -1 if not specified. Note that the sign of
z_co must be the same as the sign of C_fix.</p>
</td>
<td><code>-1</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float</code></td>
<td>
<p>the mean or individual ion activity coefficient inside the polymer.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>When <script type="math/tex"> \xi \gt \frac{1}{|z_{ct}|} </script>, ion activity coefficients are given by:</p>
<p>
<script type="math/tex; mode=display">
    \bar \gamma_{ct} = \frac{\frac{X}{\xi |z_{ct}|} + \nu_{ct} |z_{ct}|}{X + \nu_{ct} |z_{ct}|}
    exp [-\frac{\frac{X}{2}}{X+\xi |z_{co} z_{ct}| ( \nu_{co} + \nu_{ct})}]
</script>
</p>
<p>and</p>
<p>
<script type="math/tex; mode=display">
    \bar \gamma_{co} = exp [-\frac{\frac{X z_{co}^2}{2 z_{ct}^2}}{X+\xi |z_{co} z_{ct}|
    ( \nu_{co} + \nu_{ct})}]
</script>
</p>
<p>and if <script type="math/tex"> \xi \lt \frac{1}{|z_{ct}|} </script>, by</p>
<p>
<script type="math/tex; mode=display">
    \bar \gamma_{ct} = exp [-\frac{\xi \frac{X}{2}}{(X |z_{ct}| +
    (\nu_{co} z_{co}^2 + \nu_{ct} z_{ct}^2)} z_{ct}^2]
</script>
</p>
<p>and</p>
<p>
<script type="math/tex; mode=display">
\bar \gamma_{co} = exp [-\frac{\xi \frac{X}{2}}{(X |z_{ct}| + (\nu_{co} z_{co}^2 +
\bar \nu_{ct} z_{ct}^2)} z_{co}^2]
</script>
</p>
<p>where</p>
<p>
<script type="math/tex; mode=display">
X = \frac{\bar C_{co}}{\bar C_{fix}}
</script>
</p>
<p>
<script type="math/tex">\bar \gamma</script> are activity coefficients, <script type="math/tex"> \bar C_{fix} </script> is the fixed charge concentration
(including sign), <script type="math/tex"> \xi </script> is the Manning parameter, <script type="math/tex"> \bar C_{co} </script> is the co-ion concentration
in the membrane, and subscripts <script type="math/tex">co</script> and <script type="math/tex">ct</script> refer to the co-ion and counter-ion, respectively,
and overbars indicate membrane-phase quantities.</p>
<p>The mean activity coefficient is given by</p>
<p>
<script type="math/tex; mode=display">
\bar \gamma_\pm = (\gamma_{ct}^{\nu_{ct}} \gamma_{co}^{\nu_{co}})^{\frac{1}{\nu_{ct} + \nu_{co}}}
</script>
</p>
</div>
<div class="admonition references">
<p class="admonition-title">References</p>
<p>J. Kamcev, M. Galizia, F.M. Benedetti, E.-S. Jang, D.R. Paul,
B. Freeman, et al., Partitioning of Mobile Ions Between Ion Exchange
Polymers and Aqueous Salt Solutions: Importance of Counter-ion
Condensation, Phys. Chem. Chem. Phys. (2016). doi:10.1039/C5CP06747B.</p>
<p>Kamcev, J.; Paul, D. R.; Freeman, B. D. Ion Activity Coefficients in
Ion Exchange Polymers: Applicability of Manning’s Counterion Condensation
Theory. Macromolecules 2015, 48 (21), 8011–8024.</p>
<p>Manning, G. S. Limiting Laws and Counterion Condensation in
Polyelectrolyte Solutions I. Colligative Properties. J. Chem. Phys.
1969, 51 (3), 924–933.</p>
</div>
<details class="quote">
<summary>Source code in <code>membrane_toolkit/core/manning.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_activity_coefficient_manning</span><span class="p">(</span>
    <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">C_fix</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">Cs</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"mean"</span><span class="p">,</span>
    <span class="n">nu_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">nu_co</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">z_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">z_co</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return an ion activity coefficient inside a charged polymer,</span>
<span class="sd">    according to Manning theory</span>

<span class="sd">    Args:</span>
<span class="sd">        xi:</span>
<span class="sd">            Number representing the Manning parameter for the polymer,</span>
<span class="sd">            dimensionless.</span>
<span class="sd">        C_fix:</span>
<span class="sd">            Number representing the concentration of fixed charges, including sign.</span>
<span class="sd">            Must be specified in mol/L of water absorbed by the polymer. Note that</span>
<span class="sd">            monovalent charged groups are assumed.</span>
<span class="sd">        Cs:</span>
<span class="sd">            Number representing the concentraiton of mobile salt inside the</span>
<span class="sd">            polymer. Must be specified in mol/L of water absorbed by the polymer.</span>
<span class="sd">        type:</span>
<span class="sd">            Specifies whether the counter-ion, co-ion, or the mean ionic activity</span>
<span class="sd">            coefficient is returned. Valid arguments are 'counter', 'co', and</span>
<span class="sd">            'mean'. Defaults to 'mean' if not specified.</span>
<span class="sd">        nu_counter:</span>
<span class="sd">            Stoichiometric coefficient of the counter-ion in the parent salt. Defaults to 1 if not specified.</span>
<span class="sd">        nu_co : int</span>
<span class="sd">            Stoichiometric coefficient of the co-ion in the parent salt. Defaults to -1 if not specified.</span>
<span class="sd">        z_counter:</span>
<span class="sd">            Net charge, including sign, of the counter-ion. Defaults to +1 if not specified. Note that the sign of</span>
<span class="sd">            z_counter must be opposite to the sign of C_fix.</span>
<span class="sd">        z_co:</span>
<span class="sd">            Net charge, including sign, of the co-ion. Defaults to -1 if not specified. Note that the sign of</span>
<span class="sd">            z_co must be the same as the sign of C_fix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: the mean or individual ion activity coefficient inside the polymer.</span>

<span class="sd">    Notes:</span>
<span class="sd">        When \( \\xi \\gt \\frac{1}{|z_{ct}|} \), ion activity coefficients are given by:</span>

<span class="sd">        $$</span>
<span class="sd">            \\bar \\gamma_{ct} = \\frac{\\frac{X}{\\xi |z_{ct}|} + \\nu_{ct} |z_{ct}|}{X + \\nu_{ct} |z_{ct}|}</span>
<span class="sd">            exp [-\\frac{\\frac{X}{2}}{X+\\xi |z_{co} z_{ct}| ( \\nu_{co} + \\nu_{ct})}]</span>
<span class="sd">        $$</span>

<span class="sd">        and</span>

<span class="sd">        $$</span>
<span class="sd">            \\bar \\gamma_{co} = exp [-\\frac{\\frac{X z_{co}^2}{2 z_{ct}^2}}{X+\\xi |z_{co} z_{ct}|</span>
<span class="sd">            ( \\nu_{co} + \\nu_{ct})}]</span>
<span class="sd">        $$</span>

<span class="sd">        and if \( \\xi \\lt \\frac{1}{|z_{ct}|} \), by</span>

<span class="sd">        $$</span>
<span class="sd">            \\bar \\gamma_{ct} = exp [-\\frac{\\xi \\frac{X}{2}}{(X |z_{ct}| +</span>
<span class="sd">            (\\nu_{co} z_{co}^2 + \\nu_{ct} z_{ct}^2)} z_{ct}^2]</span>
<span class="sd">        $$</span>

<span class="sd">        and</span>

<span class="sd">        $$</span>
<span class="sd">        \\bar \\gamma_{co} = exp [-\\frac{\\xi \\frac{X}{2}}{(X |z_{ct}| + (\\nu_{co} z_{co}^2 +</span>
<span class="sd">        \\bar \\nu_{ct} z_{ct}^2)} z_{co}^2]</span>
<span class="sd">        $$</span>

<span class="sd">        where</span>

<span class="sd">        $$</span>
<span class="sd">        X = \\frac{\\bar C_{co}}{\\bar C_{fix}}</span>
<span class="sd">        $$</span>

<span class="sd">        \(\\bar \\gamma\) are activity coefficients, \( \\bar C_{fix} \) is the fixed charge concentration</span>
<span class="sd">        (including sign), \( \\xi \) is the Manning parameter, \( \\bar C_{co} \) is the co-ion concentration</span>
<span class="sd">        in the membrane, and subscripts \(co\) and \(ct\) refer to the co-ion and counter-ion, respectively,</span>
<span class="sd">        and overbars indicate membrane-phase quantities.</span>

<span class="sd">        The mean activity coefficient is given by</span>

<span class="sd">        $$</span>
<span class="sd">        \\bar \\gamma_\\pm = (\\gamma_{ct}^{\\nu_{ct}} \\gamma_{co}^{\\nu_{co}})^{\\frac{1}{\\nu_{ct} + \\nu_{co}}}</span>
<span class="sd">        $$</span>

<span class="sd">    References:</span>
<span class="sd">        J. Kamcev, M. Galizia, F.M. Benedetti, E.-S. Jang, D.R. Paul,</span>
<span class="sd">        B. Freeman, et al., Partitioning of Mobile Ions Between Ion Exchange</span>
<span class="sd">        Polymers and Aqueous Salt Solutions: Importance of Counter-ion</span>
<span class="sd">        Condensation, Phys. Chem. Chem. Phys. (2016). doi:10.1039/C5CP06747B.</span>

<span class="sd">        Kamcev, J.; Paul, D. R.; Freeman, B. D. Ion Activity Coefficients in</span>
<span class="sd">        Ion Exchange Polymers: Applicability of Manning’s Counterion Condensation</span>
<span class="sd">        Theory. Macromolecules 2015, 48 (21), 8011–8024.</span>

<span class="sd">        Manning, G. S. Limiting Laws and Counterion Condensation in</span>
<span class="sd">        Polyelectrolyte Solutions I. Colligative Properties. J. Chem. Phys.</span>
<span class="sd">        1969, 51 (3), 924–933.</span>
<span class="sd">    """</span>
    <span class="c1"># check to make sure the signs of the input arguments are correct</span>
    <span class="k">if</span> <span class="n">C_fix</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z_counter</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">z_co</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">"Mismatch between signs of fixed charge, counter-ion, and co-ion. Aborting."</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">C_fix</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z_counter</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">z_co</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">"Mismatch between signs of fixed charge, counter-ion, and co-ion. Aborting."</span>
            <span class="p">)</span>

    <span class="c1"># verify that the stoichiometry of the salt makes sense</span>
    <span class="k">if</span> <span class="n">z_counter</span> <span class="o">*</span> <span class="n">nu_counter</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">z_co</span> <span class="o">*</span> <span class="n">nu_co</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">"Error in input stoichiometry. z_counter * n_counter != | z_co * nu_co |. Aborting."</span>
        <span class="p">)</span>

    <span class="c1"># calculate the ratio of fixed charge to mobile salt concentration</span>
    <span class="n">X</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">C_fix</span> <span class="o">/</span> <span class="n">Cs</span><span class="p">)</span>

    <span class="c1"># calculate the critical value of the Manning parameter</span>
    <span class="n">xi_critical</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span>

    <span class="c1"># select the appropriate activity coefficient expression based on the value</span>
    <span class="c1"># of the Manning parameter</span>

    <span class="k">if</span> <span class="n">xi</span> <span class="o">&gt;=</span> <span class="n">xi_critical</span><span class="p">:</span>
        <span class="n">gamma_counter</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span> <span class="o">/</span> <span class="n">xi</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span> <span class="o">*</span> <span class="n">nu_counter</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span> <span class="o">*</span> <span class="n">nu_counter</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_co</span> <span class="o">*</span> <span class="n">z_counter</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi</span> <span class="o">*</span> <span class="p">(</span><span class="n">nu_co</span> <span class="o">+</span> <span class="n">nu_counter</span><span class="p">)))</span>

        <span class="n">gamma_co</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="o">-</span><span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">z_co</span> <span class="o">/</span> <span class="n">z_counter</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_co</span> <span class="o">*</span> <span class="n">z_counter</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi</span> <span class="o">*</span> <span class="p">(</span><span class="n">nu_co</span> <span class="o">+</span> <span class="n">nu_counter</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">xi</span> <span class="o">&lt;</span> <span class="n">xi_critical</span><span class="p">:</span>
        <span class="n">common_factor</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">xi</span> <span class="o">*</span> <span class="n">X</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">X</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">nu_counter</span> <span class="o">*</span> <span class="n">z_counter</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">nu_co</span> <span class="o">*</span> <span class="n">z_co</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">gamma_counter</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">common_factor</span> <span class="o">*</span> <span class="n">z_counter</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">gamma_co</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">common_factor</span> <span class="o">*</span> <span class="n">z_co</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># return the correct value depending on the 'type' argument</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">"counter"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gamma_counter</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">"co"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gamma_co</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">"mean"</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">gamma_counter</span> <span class="o">**</span> <span class="n">nu_counter</span> <span class="o">*</span> <span class="n">gamma_co</span> <span class="o">**</span> <span class="n">nu_co</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">nu_counter</span> <span class="o">+</span> <span class="n">nu_co</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"Invalid 'type' argument. Enter 'counter'', 'co', or 'mean'"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="membrane_toolkit.core.manning.diffusion_coefficient_manning">
<code class="highlight language-python">
membrane_toolkit.core.manning.diffusion_coefficient_manning<span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">C_fix</span><span class="p">,</span> <span class="n">Cs</span><span class="p">,</span> <span class="n">vol_frac</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">'counter'</span><span class="p">,</span> <span class="n">nu_counter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nu_co</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_counter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_co</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> </code>
<a class="headerlink" href="#membrane_toolkit.core.manning.diffusion_coefficient_manning" title="Permanent link">¶</a></h2>
<div class="doc doc-contents first">
<p>Return a diffusion coefficient inside a charged polymer,
according to Manning theory</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xi</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the Manning parameter for the polymer,
dimensionless.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>C_fix</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the concentration of fixed charges, including sign.
Must be specified in mol/L of water absorbed by the polymer. Note that
monovalent charged groups are assumed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>Cs</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the concentraiton of mobile salt inside the polymer.
Must be specified in mol/L of water absorbed by the polymer.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>vol_frac</code></td>
<td><code>float</code></td>
<td>
<p>The volume fraction of water sorbed by the ion exchange membrane.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>xi</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the Manning parameter for the polymer,
dimensionless.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>C_fix</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the concentration of fixed charges, including sign.
Must be specified in mol/L of water absorbed by the polymer. Note that
monovalent charged groups are assumed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>Cs</code></td>
<td><code>float</code></td>
<td>
<p>Number representing the concentraiton of mobile salt inside the
polymer. Must be specified in mol/L of water absorbed by the polymer.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>str</code></td>
<td>
<p>:
Specifies whether the counter-ion, co-ion, or the mean diffusion
coefficient is returned. Valid arguments are 'counter', 'co'. 'mean' is not currently implemented.
Defaults to 'counter' if not specified.</p>
</td>
<td><code>'counter'</code></td>
</tr>
<tr>
<td><code>nu_counter</code></td>
<td><code>int</code></td>
<td>
<p>Stoichiometric coefficient of the counter-ion in the parent salt. Defaults to 1 if not specified.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>nu_co</code></td>
<td><code>int</code></td>
<td>
<p>int
Stoichiometric coefficient of the co-ion in the parent salt. Defaults to -1 if not specified.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>z_counter</code></td>
<td><code>int</code></td>
<td>
<p>Net charge, including sign, of the counter-ion. Defaults to +1 if not specified. Note that the sign of
z_counter must be opposite to the sign of C_fix.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>z_co</code></td>
<td><code>int</code></td>
<td>
<p>Net charge, including sign, of the co-ion. Defaults to -1 if not specified. Note that the sign of
z_co must be the same as the sign of C_fix.</p>
</td>
<td><code>-1</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float</code></td>
<td>
<p>The mean or individual ion diffusion coefficient inside the polymer, normalized
    by the ion diffusion coefficient in bulk solution (D_mem / D_bulk).</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>When <script type="math/tex"> \xi \gt \frac{1}{|z_{ct}|} </script>, the counter-ion diffusion coefficient is given by:</p>
<p>
<script type="math/tex; mode=display">
    \frac{\bar D_{ct}}{D_{ct}} = \bigg( \frac{\frac{X}{z_{ct}^2 \nu_{ct} \xi} + 1}
    {\frac{X}{|z_{ct}| \nu_{ct}} + 1} \bigg) \bigg( 1 - \frac{1}{3} z_{ct}^2 A(\frac{1}{|z_{ct}|},
    \frac{X}{|z_{ct}| \xi}\bigg) \bigg( \frac{\phi_w}{2 - \phi_w} \bigg)^2
</script>
</p>
<p>otherwise, when <script type="math/tex"> \xi \lt \frac{1}{|z_{ct}|} </script>:</p>
<p>
<script type="math/tex; mode=display">
    \frac{\bar D_{ct}}{D_{ct}} = \bigg( 1 - \frac{1}{3} z_{ct}^2 A(\frac{1}{|z_{ct}|},
    \frac{X}{|z_{ct}| \xi}\bigg) \bigg( \frac{\phi_w}{2 - \phi_w} \bigg)^2
</script>
</p>
<p>In either case, co-ion diffusion coefficient is given by</p>
<p>
<script type="math/tex; mode=display">
    \frac{\bar D_{co}}{D_{co}} = \bigg( 1 - \frac{1}{3} z_{co}^2 A(\frac{1}{|z_{ct}|},
    \frac{X}{|z_{ct}| \xi}\bigg) \bigg( \frac{\phi_w}{2 - \phi_w} \bigg)^2
</script>
</p>
<p>where</p>
<p>
<script type="math/tex; mode=display">
    A = \sum_{m_1} \sum_{m_2} \bigg [ \pi |z_{ct}|(m_1^2+m_2^2)+|z_{ct}|+ \frac{(\nu_{ct}
    + \nu_{co})|z_{ct} z_{co}||z_{ct}| \xi}{X} \bigg]^{-2}
</script>
</p>
<p>
<script type="math/tex; mode=display">
X = \frac{\bar C_{co}}{\bar C_{fix}}
</script>
</p>
<p>
<script type="math/tex">\bar D</script> are diffusion coefficients, <script type="math/tex"> \bar C_{fix} </script> is the fixed charge concentration (including sign),
<script type="math/tex"> \xi </script> is the Manning parameter, <script type="math/tex"> \bar C_{co} </script> is the co-ion concentration in the membrane,
and subscripts <script type="math/tex">co</script> and <script type="math/tex">ct</script> refer to the co-ion and counter-ion, respectively, and overbars indicate
membrane-phase quantities.</p>
<p>The mean salt diffusion coefficient is given by</p>
<p>
<script type="math/tex; mode=display">
\bar D_s = \frac{\bar D_{ct} \bar D_{co} (z_{ct}^2 \bar C_{ct} + z_{co}^2 \bar C_{co} )}
{z_{ct}^2 \bar D_{ct} \bar C_{ct} + z_{co}^2 \bar D_{co} \bar C_{co} }
</script>
</p>
</div>
<div class="admonition references">
<p class="admonition-title">References</p>
<p>Kamcev, J.; Paul, D. R.; Manning, G. S.; Freeman, B. D. Predicting Salt Permeability Coefficients
in Highly Swollen, Highly Charged Ion Exchange Membranes. ACS Appl. Mater. Interfaces 2017, 9 (4), 4044–4056.</p>
<p>Kamcev, Jovan, Paul, Donald R., Manning, Gerald S., Freeman, B. D. Ion Diffusion Coefficients in
Ion Exchange Membranes: Significance of Counter-Ion Condensation. Macromolecules 2018, 51 (15), 5519–5529.</p>
<p>Manning, G. S. Limiting Laws and Counterion Condensation in Polyelectrolyte Solutions II.
Self‐ Diffusion of the Small Ions. J. Chem. Phys. 1969, 51 (3), 934–938.</p>
</div>
<details class="quote">
<summary>Source code in <code>membrane_toolkit/core/manning.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">diffusion_coefficient_manning</span><span class="p">(</span>
    <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">C_fix</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">Cs</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">vol_frac</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"counter"</span><span class="p">,</span>
    <span class="n">nu_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">nu_co</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">z_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">z_co</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return a diffusion coefficient inside a charged polymer,</span>
<span class="sd">    according to Manning theory</span>

<span class="sd">    Args:</span>
<span class="sd">        xi:</span>
<span class="sd">            Number representing the Manning parameter for the polymer,</span>
<span class="sd">            dimensionless.</span>
<span class="sd">        C_fix:</span>
<span class="sd">            Number representing the concentration of fixed charges, including sign.</span>
<span class="sd">            Must be specified in mol/L of water absorbed by the polymer. Note that</span>
<span class="sd">            monovalent charged groups are assumed.</span>
<span class="sd">        Cs:</span>
<span class="sd">            Number representing the concentraiton of mobile salt inside the polymer.</span>
<span class="sd">            Must be specified in mol/L of water absorbed by the polymer.</span>
<span class="sd">        vol_frac:</span>
<span class="sd">            The volume fraction of water sorbed by the ion exchange membrane.</span>
<span class="sd">        xi:</span>
<span class="sd">            Number representing the Manning parameter for the polymer,</span>
<span class="sd">            dimensionless.</span>
<span class="sd">        C_fix:</span>
<span class="sd">            Number representing the concentration of fixed charges, including sign.</span>
<span class="sd">            Must be specified in mol/L of water absorbed by the polymer. Note that</span>
<span class="sd">            monovalent charged groups are assumed.</span>
<span class="sd">        Cs:</span>
<span class="sd">            Number representing the concentraiton of mobile salt inside the</span>
<span class="sd">            polymer. Must be specified in mol/L of water absorbed by the polymer.</span>
<span class="sd">        type::</span>
<span class="sd">            Specifies whether the counter-ion, co-ion, or the mean diffusion</span>
<span class="sd">            coefficient is returned. Valid arguments are 'counter', 'co'. 'mean' is not currently implemented.</span>
<span class="sd">            Defaults to 'counter' if not specified.</span>
<span class="sd">        nu_counter:</span>
<span class="sd">            Stoichiometric coefficient of the counter-ion in the parent salt. Defaults to 1 if not specified.</span>
<span class="sd">        nu_co : int</span>
<span class="sd">            Stoichiometric coefficient of the co-ion in the parent salt. Defaults to -1 if not specified.</span>
<span class="sd">        z_counter:</span>
<span class="sd">            Net charge, including sign, of the counter-ion. Defaults to +1 if not specified. Note that the sign of</span>
<span class="sd">            z_counter must be opposite to the sign of C_fix.</span>
<span class="sd">        z_co:</span>
<span class="sd">            Net charge, including sign, of the co-ion. Defaults to -1 if not specified. Note that the sign of</span>
<span class="sd">            z_co must be the same as the sign of C_fix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The mean or individual ion diffusion coefficient inside the polymer, normalized</span>
<span class="sd">            by the ion diffusion coefficient in bulk solution (D_mem / D_bulk).</span>

<span class="sd">    Notes:</span>
<span class="sd">        When \( \\xi \\gt \\frac{1}{|z_{ct}|} \), the counter-ion diffusion coefficient is given by:</span>

<span class="sd">        $$</span>
<span class="sd">            \\frac{\\bar D_{ct}}{D_{ct}} = \\bigg( \\frac{\\frac{X}{z_{ct}^2 \\nu_{ct} \\xi} + 1}</span>
<span class="sd">            {\\frac{X}{|z_{ct}| \\nu_{ct}} + 1} \\bigg) \\bigg( 1 - \\frac{1}{3} z_{ct}^2 A(\\frac{1}{|z_{ct}|},</span>
<span class="sd">            \\frac{X}{|z_{ct}| \\xi}\\bigg) \\bigg( \\frac{\\phi_w}{2 - \\phi_w} \\bigg)^2</span>
<span class="sd">        $$</span>

<span class="sd">        otherwise, when \( \\xi \\lt \\frac{1}{|z_{ct}|} \):</span>

<span class="sd">        $$</span>
<span class="sd">            \\frac{\\bar D_{ct}}{D_{ct}} = \\bigg( 1 - \\frac{1}{3} z_{ct}^2 A(\\frac{1}{|z_{ct}|},</span>
<span class="sd">            \\frac{X}{|z_{ct}| \\xi}\\bigg) \\bigg( \\frac{\\phi_w}{2 - \\phi_w} \\bigg)^2</span>
<span class="sd">        $$</span>

<span class="sd">        In either case, co-ion diffusion coefficient is given by</span>

<span class="sd">        $$</span>
<span class="sd">            \\frac{\\bar D_{co}}{D_{co}} = \\bigg( 1 - \\frac{1}{3} z_{co}^2 A(\\frac{1}{|z_{ct}|},</span>
<span class="sd">            \\frac{X}{|z_{ct}| \\xi}\\bigg) \\bigg( \\frac{\\phi_w}{2 - \\phi_w} \\bigg)^2</span>
<span class="sd">        $$</span>

<span class="sd">        where</span>

<span class="sd">        $$</span>
<span class="sd">            A = \\sum_{m_1} \\sum_{m_2} \\bigg [ \\pi |z_{ct}|(m_1^2+m_2^2)+|z_{ct}|+ \\frac{(\\nu_{ct}</span>
<span class="sd">            + \\nu_{co})|z_{ct} z_{co}||z_{ct}| \\xi}{X} \\bigg]^{-2}</span>
<span class="sd">        $$</span>

<span class="sd">        $$</span>
<span class="sd">        X = \\frac{\\bar C_{co}}{\\bar C_{fix}}</span>
<span class="sd">        $$</span>

<span class="sd">        \(\\bar D\) are diffusion coefficients, \( \\bar C_{fix} \) is the fixed charge concentration (including sign),</span>
<span class="sd">        \( \\xi \) is the Manning parameter, \( \\bar C_{co} \) is the co-ion concentration in the membrane,</span>
<span class="sd">        and subscripts \(co\) and \(ct\) refer to the co-ion and counter-ion, respectively, and overbars indicate</span>
<span class="sd">        membrane-phase quantities.</span>

<span class="sd">        The mean salt diffusion coefficient is given by</span>

<span class="sd">        $$</span>
<span class="sd">        \\bar D_s = \\frac{\\bar D_{ct} \\bar D_{co} (z_{ct}^2 \\bar C_{ct} + z_{co}^2 \\bar C_{co} )}</span>
<span class="sd">        {z_{ct}^2 \\bar D_{ct} \\bar C_{ct} + z_{co}^2 \\bar D_{co} \\bar C_{co} }</span>
<span class="sd">        $$</span>

<span class="sd">    References:</span>
<span class="sd">        Kamcev, J.; Paul, D. R.; Manning, G. S.; Freeman, B. D. Predicting Salt Permeability Coefficients</span>
<span class="sd">        in Highly Swollen, Highly Charged Ion Exchange Membranes. ACS Appl. Mater. Interfaces 2017, 9 (4), 4044–4056.</span>

<span class="sd">        Kamcev, Jovan, Paul, Donald R., Manning, Gerald S., Freeman, B. D. Ion Diffusion Coefficients in</span>
<span class="sd">        Ion Exchange Membranes: Significance of Counter-Ion Condensation. Macromolecules 2018, 51 (15), 5519–5529.</span>

<span class="sd">        Manning, G. S. Limiting Laws and Counterion Condensation in Polyelectrolyte Solutions II.</span>
<span class="sd">        Self‐ Diffusion of the Small Ions. J. Chem. Phys. 1969, 51 (3), 934–938.</span>
<span class="sd">    """</span>
    <span class="c1"># check to make sure the signs of the input arguments are correct</span>
    <span class="k">if</span> <span class="n">C_fix</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z_counter</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">z_co</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">"Mismatch between signs of fixed charge, counter-ion, and co-ion. Aborting."</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">C_fix</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z_counter</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">z_co</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">"Mismatch between signs of fixed charge, counter-ion, and co-ion. Aborting."</span>
            <span class="p">)</span>

    <span class="c1"># calculate the ratio of fixed charge to mobile salt concentration</span>
    <span class="n">X</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">C_fix</span> <span class="o">/</span> <span class="n">Cs</span><span class="p">)</span>

    <span class="c1"># calculate the critical value of the Manning parameter</span>
    <span class="n">xi_critical</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span>

    <span class="c1"># select the appropriate activity coefficient expression based on the value</span>
    <span class="c1"># of the Manning parameter</span>
    <span class="k">if</span> <span class="n">xi</span> <span class="o">&gt;=</span> <span class="n">xi_critical</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">_A</span><span class="p">(</span>
            <span class="mi">1</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">),</span>
            <span class="n">X</span> <span class="o">/</span> <span class="n">xi</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">),</span>
            <span class="n">nu_counter</span><span class="o">=</span><span class="n">nu_counter</span><span class="p">,</span>
            <span class="n">nu_co</span><span class="o">=</span><span class="n">nu_co</span><span class="p">,</span>
            <span class="n">z_counter</span><span class="o">=</span><span class="n">z_counter</span><span class="p">,</span>
            <span class="n">z_co</span><span class="o">=</span><span class="n">z_co</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">D_counter</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="p">(</span><span class="n">z_counter</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nu_counter</span> <span class="o">*</span> <span class="n">xi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z_counter</span><span class="p">)</span> <span class="o">*</span> <span class="n">nu_counter</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">z_counter</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">vol_frac</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vol_frac</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">xi</span> <span class="o">&lt;</span> <span class="n">xi_critical</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">_A</span><span class="p">(</span>
            <span class="n">xi</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">nu_counter</span><span class="o">=</span><span class="n">nu_counter</span><span class="p">,</span> <span class="n">nu_co</span><span class="o">=</span><span class="n">nu_co</span><span class="p">,</span> <span class="n">z_counter</span><span class="o">=</span><span class="n">z_counter</span><span class="p">,</span> <span class="n">z_co</span><span class="o">=</span><span class="n">z_co</span>
        <span class="p">)</span>

        <span class="n">D_counter</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">z_counter</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">vol_frac</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vol_frac</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">D_co</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">z_co</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">vol_frac</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vol_frac</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="c1"># return the correct value depending on the 'type' argument</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">"counter"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D_counter</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">"co"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D_co</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">'Invalid "type" argument. Enter "counter" or "co"'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../donnan/" rel="prev" title="Donnan Equilibrium">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Donnan Equilibrium
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../potential/" rel="next" title="Electrochemical Properties">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Electrochemical Properties
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            2020 Ryan Kingsbury
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.a0c4167b.min.js"></script>
<script src="../../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script src="../../mathjaxhelper.js"></script>
</body>
</html>