
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Documentation for membrane-toolkit, Python tools for membrane science." name="description"/>
<link href="https://rkingsbury.github.io/membrane-toolkit/core_functions/donnan/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-5.1.6" name="generator"/>
<title>Donnan Equilibrium - membrane-toolkit Documentation</title>
<link href="../../assets/stylesheets/main.4b9ffd7b.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.b79bcd20.min.css" rel="stylesheet"/>
<meta content="#03a9f4" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body data-md-color-accent="deep-orange" data-md-color-primary="light-blue" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#membrane_toolkit.core.donnan.donnan_equilibrium">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="membrane-toolkit Documentation" class="md-header-nav__button md-logo" href="https://rkingsbury.github.io/membrane-toolkit/" title="membrane-toolkit Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            membrane-toolkit Documentation
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Donnan Equilibrium
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/rkingsbury/membrane-toolkit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="membrane-toolkit Documentation" class="md-nav__button md-logo" href="https://rkingsbury.github.io/membrane-toolkit/" title="membrane-toolkit Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    membrane-toolkit Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/rkingsbury/membrane-toolkit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Home">
      Home
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/" title="Installation">
      Installation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting_started/" title="Getting Started">
      Getting Started
    </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Core Functions
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Core Functions" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-4">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Core Functions
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../diffusion/" title="Diffusion">
      Diffusion
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Donnan Equilibrium
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Donnan Equilibrium">
      Donnan Equilibrium
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#membrane_toolkit.core.donnan.donnan_equilibrium">
    donnan_equilibrium()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../manning/" title="Manning Theory">
      Manning Theory
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../potential/" title="Electrochemical Properties">
      Electrochemical Properties
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../develop/" title="For Developers">
      For Developers
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#membrane_toolkit.core.donnan.donnan_equilibrium">
    donnan_equilibrium()
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/rkingsbury/membrane-toolkit/edit/master/docs/core_functions/donnan.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1>Donnan Equilibrium</h1>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="membrane_toolkit.core.donnan.donnan_equilibrium">
<code class="highlight language-python">
membrane_toolkit.core.donnan.donnan_equilibrium<span class="p">(</span><span class="n">C_bulk</span><span class="p">,</span> <span class="n">C_fix</span><span class="p">,</span> <span class="n">z_counter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_co</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nu_counter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nu_co</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_fix</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> </code>
<a class="headerlink" href="#membrane_toolkit.core.donnan.donnan_equilibrium" title="Permanent link">¶</a></h2>
<div class="doc doc-contents first">
<p>Calculate the Donnan equilibrium at the interface between Phase1 and Phase2.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C_bulk</code></td>
<td><code>float</code></td>
<td>
<p>bulk salt concentration [mol/L]</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>C_fix</code></td>
<td><code>float</code></td>
<td>
<p>fixed charge concentration, without sign [mol/L]</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>z_counter</code></td>
<td><code>int</code></td>
<td>
<p>signed charge of the counter-ion. Default = +1 [dimensionless]</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>z_co</code></td>
<td><code>int</code></td>
<td>
<p>signed charge of the co-ion. By definition, this must have the same sign as the co-ion.
Default = -1 [dimensionless]</p>
</td>
<td><code>-1</code></td>
</tr>
<tr>
<td><code>nu_counter</code></td>
<td><code>int</code></td>
<td>
<p>stoichiometric coefficient of the counter-ion.
Default = 1 [dimensionless]</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>nu_co</code></td>
<td><code>int</code></td>
<td>
<p>stoichiometric coefficient of the co-ion.
Default = 1 [dimensionless]</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>z_fix</code></td>
<td><code>int</code></td>
<td>
<p>signed charge of the fixed groups. Default = -1 [dimensionless]</p>
</td>
<td><code>-1</code></td>
</tr>
<tr>
<td><code>gamma</code></td>
<td><code>float</code></td>
<td>
<p>stoichiometrically-weighted ratio of salt activity coefficient in
solution to that in the membrane Default = 1 [dimensionless].</p>
</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float</code></td>
<td>
<p>The co-ion concentration in the membrane [mol/L]. Note that for salts containing one or more
       multivalent ions, this is not the same as the mobile salt concentration.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AssertionError</code></td>
<td>
<p>If the input stoichiometry is incorrect. Both <script type="math/tex"> \nu </script> must be positive, <script type="math/tex"> z_{counter} </script>
and <script type="math/tex"> z_{fix} </script> must have opposite signs, and <script type="math/tex"> \nu_{counter} * z_{counter} </script> +
<script type="math/tex"> \nu_{co} * z_{co} </script> must equal zero.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>The Donnan equilibrium between a membrane with fixed charged concentration <script type="math/tex"> \bar C_{fix} </script>
(mol per L water sorbed) and a salt solution of bulk concentration <script type="math/tex"> C_s </script> (mol/L) is given by:</p>
<p>
<script type="math/tex; mode=display">
\bar C_{co}^{\nu_{co}} \big ( \frac{z_{co} \bar C_{co} + z_{fix} \bar C_{fix}}{z_{ct}}         \big )^{\nu_{ct}} = - \Gamma \nu_{ct}^{\nu_{ct}} \nu_{co}^{\nu_{co}} C_s^{\nu_{ct} + \nu_{co}}
</script>
</p>
<p>where subscripts <script type="math/tex"> co </script> and <script type="math/tex"> ct </script> indicate the co-ion (same charge as the membrane) and counter-ion
(opposite charge to the membrane), <script type="math/tex"> \nu </script> (dimensionless) are stoichiometric coefficients, and overbars
indicate membrane-phase quantities, in units of moles per liter of water sorbed by the membrane. <script type="math/tex"> \Gamma </script>
(dimensionless) is the ratio of activity coefficients in the bulk solution to those in the membrane, given by:</p>
<p>
<script type="math/tex; mode=display">
\Gamma = \frac{\gamma_{\pm}^{\nu_{ct} +             \nu_{co}}}{\bar \gamma_{ct}^{\nu_{ct}} \bar \gamma_{co}^{\nu_{co}}}
</script>
</p>
<p>Traditionally, <script type="math/tex"> \Gamma </script> is either set to 1 (implying that ion activity coefficients are the same in the
membrane and in bulk solution), or the ions are assumed to behave ideally in the membrane (activity coefficient
in the membrane equal to 1), in which case <span><span class="MathJax_Preview">$\Gamma$</span><script type="math/tex">\Gamma</script></span> equals the bulk solution activity coefficient. More
recently, Manning theory has been used to compute the membrane-phase activity coefficients, making possible a
direct calculation of <script type="math/tex"> \Gamma </script>.</p>
</div>
<div class="admonition references">
<p class="admonition-title">References</p>
<p>Donnan, F. G. The theory of membrane equilibria. Chem. Rev. 1924, 1 (1), 73–90.</p>
<p>Kamcev, J.; Galizia, M.; Benedetti, F. M.; Jang, E.-S.; Paul, D. R.;
Freeman, B.; Manning, G. S. Partitioning of Mobile Ions Between Ion Exchange Polymers and Aqueous Salt
Solutions: Importance of Counter-ion Condensation. Phys. Chem. Chem. Phys. 2016, No. 8, 6021–6031.</p>
<p>Galizia, M.; Manning, G. S.; Paul, D. R.; Freeman, B. D. Ion partitioning between brines and ion exchange
polymers. Polymer (Guildf). 2019, 165 (January), 91–100.</p>
<p>Kingsbury, R. S.; Coronell, O. Modelling and validation of concentration dependence of ion exchange membrane
permselectivity: significance of convection and Manning’s counter-ion condensation theory. Submitted.</p>
</div>
<details class="quote">
<summary>Source code in <code>membrane_toolkit/core/donnan.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">donnan_equilibrium</span><span class="p">(</span>
    <span class="n">C_bulk</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">C_fix</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">z_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">z_co</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">nu_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">nu_co</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">z_fix</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Calculate the Donnan equilibrium at the interface between Phase1 and Phase2.</span>

<span class="sd">    Args:</span>
<span class="sd">        C_bulk: bulk salt concentration [mol/L]</span>
<span class="sd">        C_fix: fixed charge concentration, without sign [mol/L]</span>
<span class="sd">        z_counter: signed charge of the counter-ion. Default = +1 [dimensionless]</span>
<span class="sd">        z_co: signed charge of the co-ion. By definition, this must have the same sign as the co-ion.</span>
<span class="sd">            Default = -1 [dimensionless]</span>
<span class="sd">        nu_counter: stoichiometric coefficient of the counter-ion.</span>
<span class="sd">            Default = 1 [dimensionless]</span>
<span class="sd">        nu_co: stoichiometric coefficient of the co-ion.</span>
<span class="sd">            Default = 1 [dimensionless]</span>
<span class="sd">        z_fix: signed charge of the fixed groups. Default = -1 [dimensionless]</span>
<span class="sd">        gamma: stoichiometrically-weighted ratio of salt activity coefficient in</span>
<span class="sd">            solution to that in the membrane Default = 1 [dimensionless].</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The co-ion concentration in the membrane [mol/L]. Note that for salts containing one or more</span>
<span class="sd">               multivalent ions, this is not the same as the mobile salt concentration.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If the input stoichiometry is incorrect. Both \( \\nu \) must be positive, \( z_{counter} \)</span>
<span class="sd">            and \( z_{fix} \) must have opposite signs, and \( \\nu_{counter} * z_{counter} \) +</span>
<span class="sd">            \( \\nu_{co} * z_{co} \) must equal zero.</span>

<span class="sd">    Notes:</span>
<span class="sd">        The Donnan equilibrium between a membrane with fixed charged concentration \( \\bar C_{fix} \)</span>
<span class="sd">        (mol per L water sorbed) and a salt solution of bulk concentration \( C_s \) (mol/L) is given by:</span>

<span class="sd">        $$</span>
<span class="sd">        \\bar C_{co}^{\\nu_{co}} \\big ( \\frac{z_{co} \\bar C_{co} + z_{fix} \\bar C_{fix}}{z_{ct}} \</span>
<span class="sd">        \\big )^{\\nu_{ct}} = - \\Gamma \\nu_{ct}^{\\nu_{ct}} \\nu_{co}^{\\nu_{co}} C_s^{\\nu_{ct} + \\nu_{co}}</span>
<span class="sd">        $$</span>

<span class="sd">        where subscripts \( co \) and \( ct \) indicate the co-ion (same charge as the membrane) and counter-ion</span>
<span class="sd">        (opposite charge to the membrane), \( \\nu \) (dimensionless) are stoichiometric coefficients, and overbars</span>
<span class="sd">        indicate membrane-phase quantities, in units of moles per liter of water sorbed by the membrane. \( \\Gamma \)</span>
<span class="sd">        (dimensionless) is the ratio of activity coefficients in the bulk solution to those in the membrane, given by:</span>

<span class="sd">        $$</span>
<span class="sd">        \\Gamma = \\frac{\\gamma_{\\pm}^{\\nu_{ct} + \</span>
<span class="sd">            \\nu_{co}}}{\\bar \\gamma_{ct}^{\\nu_{ct}} \\bar \\gamma_{co}^{\\nu_{co}}}</span>
<span class="sd">        $$</span>

<span class="sd">        Traditionally, \( \\Gamma \) is either set to 1 (implying that ion activity coefficients are the same in the</span>
<span class="sd">        membrane and in bulk solution), or the ions are assumed to behave ideally in the membrane (activity coefficient</span>
<span class="sd">        in the membrane equal to 1), in which case $\Gamma$ equals the bulk solution activity coefficient. More</span>
<span class="sd">        recently, Manning theory has been used to compute the membrane-phase activity coefficients, making possible a</span>
<span class="sd">        direct calculation of \( \\Gamma \).</span>

<span class="sd">    References:</span>
<span class="sd">        Donnan, F. G. The theory of membrane equilibria. Chem. Rev. 1924, 1 (1), 73–90.</span>

<span class="sd">        Kamcev, J.; Galizia, M.; Benedetti, F. M.; Jang, E.-S.; Paul, D. R.;</span>
<span class="sd">        Freeman, B.; Manning, G. S. Partitioning of Mobile Ions Between Ion Exchange Polymers and Aqueous Salt</span>
<span class="sd">        Solutions: Importance of Counter-ion Condensation. Phys. Chem. Chem. Phys. 2016, No. 8, 6021–6031.</span>

<span class="sd">        Galizia, M.; Manning, G. S.; Paul, D. R.; Freeman, B. D. Ion partitioning between brines and ion exchange</span>
<span class="sd">        polymers. Polymer (Guildf). 2019, 165 (January), 91–100.</span>

<span class="sd">        Kingsbury, R. S.; Coronell, O. Modelling and validation of concentration dependence of ion exchange membrane</span>
<span class="sd">        permselectivity: significance of convection and Manning’s counter-ion condensation theory. Submitted.</span>
<span class="sd">    """</span>
    <span class="c1"># validate input arguments</span>
    <span class="k">assert</span> <span class="n">nu_counter</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">nu_co</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">nu_counter</span> <span class="o">*</span> <span class="n">z_counter</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">nu_co</span> <span class="o">*</span> <span class="n">z_co</span>
    <span class="k">assert</span> <span class="n">z_fix</span> <span class="o">*</span> <span class="n">z_counter</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_donnan_solver</span><span class="p">(</span><span class="n">C_co</span><span class="p">):</span>
        <span class="c1"># private function to interatively solve for co-ion concentration.</span>

        <span class="c1"># return the error squared so we can utilize a scalar minimization routine</span>
        <span class="k">return</span> <span class="n">C_co</span> <span class="o">**</span> <span class="n">nu_co</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">z_co</span> <span class="o">*</span> <span class="n">C_co</span> <span class="o">+</span> <span class="n">z_fix</span> <span class="o">*</span> <span class="n">C_fix</span><span class="p">)</span> <span class="o">/</span> <span class="n">z_counter</span>
        <span class="p">)</span> <span class="o">**</span> <span class="n">nu_counter</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">nu_co</span> <span class="o">**</span> <span class="n">nu_co</span> <span class="o">*</span> <span class="n">nu_counter</span> <span class="o">**</span> <span class="n">nu_counter</span> <span class="o">*</span> <span class="n">C_bulk</span> <span class="o">**</span> <span class="p">(</span>
            <span class="n">nu_counter</span> <span class="o">+</span> <span class="n">nu_co</span>
        <span class="p">)</span>

    <span class="c1"># solve the function above using one of scipy's nonlinear solvers</span>
    <span class="c1"># from scipy.optimize import minimize</span>
    <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root_scalar</span>

    <span class="c1"># call a solver to solve for the co-ion concentration</span>
    <span class="c1"># result = minimize(_donnan_solver, 0.01, method="TNC", bounds=[(0, C_bulk * nu_co * 10)])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span>
        <span class="n">_donnan_solver</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">C_bulk</span> <span class="o">*</span> <span class="n">nu_co</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">C_bulk</span> <span class="o">*</span> <span class="n">nu_co</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># after solving for the co-ion concentration,</span>
    <span class="c1"># calculate the counter-ion concentraiton, Cg</span>
    <span class="c1"># result_counter = -(result_co * z_co + zfix * Cfix) / z_counter</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">converged</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">root</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="s2"> failed to find a solution"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="vm">__name__</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../diffusion/" rel="prev" title="Diffusion">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Diffusion
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../manning/" rel="next" title="Manning Theory">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Manning Theory
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            2020 Ryan Kingsbury
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.a0c4167b.min.js"></script>
<script src="../../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script src="../../mathjaxhelper.js"></script>
</body>
</html>